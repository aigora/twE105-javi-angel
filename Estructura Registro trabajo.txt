#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <math.h>
#include <string.h>
#include <stdlib.h>
struct Fecha {
	int dia;
	int mes;
	int año;
};
 struct Usuario {
	char nombre[30];
	struct Fecha nacimiento;
	char sexo;
	char nom_usuario[25];
	char contraseña[25];
	char ocupacion[30];
	int cochesasignados;
 };
 void registro(struct Usuario usuarios[], int i);
void main() {
	system("chcp 1252");
	system("cls");
	int num_user = 2;
	struct Usuario user[3] = { { "Javs", "contra", "Mecánico", 3 }, {"Ángel", "1234", "Administrador", 0 } };
	FILE *pf;
	int i, caso;
	prinf("1| Regristrarse\n\n2| Salir");
	scanf("%d", &caso);
	switch (caso) {
	case 1: {
		void registro(user, num_user);
		num_user++;
		break;
	}
	case 2:
		printf("Saliendo del programa...\n");
		//animacionbasic;
		//guardar(usuarios, , num_user);
		return 0;

	}

	
	
}

void registro(struct Usuario usuarios[], int i) {
	int  aux_2 = 0, aux_1, k;
	char contrasena2[25], nada[2] = "-";
	system("cls");
	printf("------------------REGISTRO------------------\n");
	printf("Introducir nombre:\n");
	getchar();
	scanf("%s", usuarios[i].nombre);

	//Fecha de nacimiento
	printf("Introducir fecha de nacimiento:\n");
	printf("Introducir día:\n");
	do {
		getchar();
		scanf("%d", &usuarios[i].nacimiento.dia);
		if (usuarios[i].nacimiento.dia < 1 || usuarios[i].nacimiento.dia > 31) {
			printf("Introduzca de nuevo el día, por favor\n");
		}
	} while (usuarios[i].nacimiento.dia < 1 || usuarios[i].nacimiento.dia > 31);
	printf("Introducir mes:\n");
	do {
		do {
			if ((usuarios[i].nacimiento.dia == 31 && (usuarios[i].nacimiento.mes == 2 || usuarios[i].nacimiento.mes == 4 || usuarios[i].nacimiento.mes == 6 || usuarios[i].nacimiento.mes == 9 || usuarios[i].nacimiento.mes == 11)) || (usuarios[i].nacimiento.dia > 29 && usuarios[i].nacimiento.mes == 2)) {
				printf("Introduzca de nuevo el mes, por favor\n");
			}
			getchar();
			scanf("%d", &usuarios[i].nacimiento.mes);
		} while ((usuarios[i].nacimiento.dia == 31 && (usuarios[i].nacimiento.mes == 2 || usuarios[i].nacimiento.mes == 4 || usuarios[i].nacimiento.mes == 6 || usuarios[i].nacimiento.mes == 9 || usuarios[i].nacimiento.mes == 11)) || (usuarios[i].nacimiento.dia > 29 && usuarios[i].nacimiento.mes == 2));
		if (usuarios[i].nacimiento.mes < 1 || usuarios[i].nacimiento.mes > 12) {
			printf("Introduzca de nuevo el mes, por favor\n");
		}
	} while (usuarios[i].nacimiento.mes < 1 || usuarios[i].nacimiento.mes > 12);
	printf("Introducir año:\n");
	do {
		getchar();
		scanf("%d", &usuarios[i].nacimiento.año);
		if (usuarios[i].nacimiento.año < 1900 || usuarios[i].nacimiento.año > 2000) {
			printf("Introduzca de nuevo el año, por favor\n");
		}
	} while (usuarios[i].nacimiento.año < 1900 || usuarios[i].nacimiento.año > 2000);


	//Sexo
	printf("Introducir sexo Masculino 'M' o Femenino 'F' u Otro 'O':\n");
	do {
		getchar();
		scanf("%c", &usuarios[i].sexo);
		if ((usuarios[i].sexo != 'M' && usuarios[i].sexo != 'F' && usuarios[i].sexo != 'O')) {
			printf("Introduzca de nuevo el sexo Masculino 'M' o Femenino 'F' u Otro 'O':\n");
		}
	} while (usuarios[i].sexo != 'M' && usuarios[i].sexo != 'F' && usuarios[i].sexo != 'O');

	//Usuario
	printf("Introducir nombre de usuario (máximo 25 caracteres):\n");
	aux_1 = 0;
	do {
		if (aux_1 == 1) {
			printf("El usuario ya es existente, por favor introduzcalo de nuevo\n");
		}
		getchar();
		scanf("%s", usuarios[i].nombre);
		for (k = 0; k < i; k++) {
			if (strcmp(usuarios[k].nom_usuario, usuarios[i].nom_usuario) == 0) {
				aux_1 = 1;
				break;
			}
			else {
				aux_1 = 0;
			}
		}
	} while (aux_1 == 1);

	//Contraseña
	do {
		if (aux_2 == 1) {
			printf("Las contraseñas introducidas son distintas, por favor comience el proceso de nuevo\n");
		}
		printf("Introducir contraseña (máximo 25 caracteres):\n");
		do {
			getchar();
			scanf("%s", usuarios[i].contraseña);
			if (strlen(usuarios[i].contraseña) < 4) {
				printf("Su contraseña es muy insegura, por favor introduzca más de 3 caracteres\n");
			}
		} while (strlen(usuarios[i].contraseña) < 4);
		printf("Introducir contraseña por segunda vez:\n");
		getchar();
		scanf("%s", contrasena2);
		if (strcmp(usuarios[i].contraseña, contrasena2) != 0) {
			aux_2 = 1;
		}
		else {
			aux_2 = 0;
		}
	} while (aux_2 == 1);
	system("cls");
	printf("¡SE HA REGISTRADO CON EXITO!\n");
	printf("------------------------------\n");
}